$def with (matkat, params, t, dt)

DEBUG
<strong>$t s</strong>
$for k, v in params.iteritems():
  $k=<strong>$v</strong>
dt=<strong>$dt</strong>

<div class="container-fluid">
<div class="row-fluid">

<!-- Hakulomake sivupalkissa -->
<div class="span3">
<div class="well sidebar-nav sidebar-nav-fixed">
  <h3>Hae yhteyksiä</h3>
  <form class="form-horizontal" method="GET" action="Joukkoliikenteen hintavertailu - tulokset.htm" id="lomake">
    <label>Mistä</label>
    <input class="input" id="inputMista" type="text" name="mista" autocomplete="off" required="" autofocus="" pattern="[a-zA-ZäÄåÅöÖ]+">
    <label>Minne</label>
    <input id="inputMihin" type="text" name="mihin" autocomplete="off" required="" "[a-zA-ZäÄåÅöÖ]+">
    <div class="breaker"></div>
    <br>
    <label>Aika ja Pvm</label>
    <input type="text" class="input-xmini" id="inputTunnit" name="h" pattern="[0-9]|0[0-9]|1[0-9]|2[0-3]">
    <small>:</small>
    <input type="text" class="input-xmini" id="inputMinuutit" name="min" pattern="[0-9]|0[0-9]|[1-5][0-9]">
    <input type="text" class="input-small" id="inputPvm" name="pvm" pattern="([1-9]|1[0-9]|2[0-9]|3[1]).([1-9]|1[12]).[0-9]{4}">
    <br>
    <div id="datepicker"></div>
    <select id="inputAikatyyppi" class="input-medium" name="tyyppi">
        <option>Lähtöaika</option>
        <option>Saapumisaika</option>
    </select>
    <div class="breaker"></div>
    <br>
    <label>Alennusluokka</label>
    <select id="inputAlennusluokka" class="input-medium" name="luokka">
      <option value="0">Aikuinen</option>
      <option value="1">Lapsi(4-11 v)</option>
      <option value="3">Nuori(12-16 v)</option>
      <option value="2">Opiskelija</option>
      <option value="5">Varusmies</option>
      <option value="7">Siviilipalvelusmies</option>
      <option value="4">Eläkeläinen</option>
      <option value="6">Lehdistö</option>
    </select>
    <label>Auton keskikulutus</label>
    <select id="inputKeskikulutus" class="input-large" name="kulutus">
      <option value="95|4,5">95E, Pieni (4,5l/100km)</option>
      <option value="95|6,5">95E, Keski(6,5l/100km)</option>
      <option value="95|8,5">95E, Suuri (8,5l/100km)</option>
      <option class="select-dash" disabled="disabled">----</option>
      <option value="98|4,5">98E, Pieni (4,5l/100km)</option>
      <option value="98|6,5">98E, Keski (6,5l/100km)</option>
      <option value="98|8,5">98E, Suuri (8,5l/100km)</option>
      <option class="select-dash" disabled="disabled">----</option>
      <option value="Di|3,7">Di, Pieni (3,7l/100km)</option>
      <option value="Di|5,7">Di, Keski (5,7l/100km)</option>
      <option value="Di|7,7">Di, Suuri (7,7l/100km)</option>
    </select>
    <br>

    <label class="checkbox inline">
      <input type="checkbox" name="juna" checked=""> Juna
    </label>
    <label class="checkbox inline">
      <input type="checkbox" name="bussi" checked=""> Bussi
    </label>
    <label class="checkbox inline">
      <input type="checkbox" name="auto" checked=""> Auto
    </label>
    <br>
    <button class="btn-custom" type="submit">Hae yhteyksiä<i class="icon-search"></i></button>
  </form>
</div> <!-- /.sidebar-nav-fixed -->
</div> <!-- /.span3 -->


<!-- Hakutulokset -->
<div class="span9" style="height:1000px;">
<div id="option">
    <input type="button" value="lähtö" onclick="sortByDt1()"/>
    <input type="button" value="saapuminen" onclick="sortByDt2()"/>
    <input type="button" value="kesto" onclick="sortByDuration()"/>
    <input type="button" value="hinta" onclick="sortByPrice()"/>
    <input type="button" value="vaihdot" onclick="sortByTransfers()"/>
</div>
<div class="results"></div>
</div> <!-- /.span* -->
</div> <!-- /.container -->
</div> <!-- /.row -->
<script>
var query_date = "$dt";
var data = [

$if "auto" in matkat and not "virhe" in matkat["auto"]:
    $ m = matkat["auto"]
    {"luokka":"auto","lahtoaika":"$m["js_aika"]","tunnit":$m["tunnit"],"kesto":"$m["kesto"]","hinta":$m["hinta"],"vaihdot_lkm":0,"tyyppi":"Auto"},

$code:
    mh_ja_vr = []
    for x in ["juna", "bussi"]:
        if x in matkat and not "virhe" in matkat[x]:
            mh_ja_vr += matkat[x]

$for m in mh_ja_vr:
    {"luokka":"$m["luokka"]","lahtoaika":"$m["js_aika"]","tunnit":$m["tunnit"],"kesto":"$m["kesto"]","hinta":$m["hinta"],"vaihdot_lkm":$m["vaihdot_lkm"],"tyyppi":"$m["tyyppi"]"},

]
</script>
<script src="/static/js/d3.v3.min.js"></script>
<script src="/static/js/d3testi.js"></script>
