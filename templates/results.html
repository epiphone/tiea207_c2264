$def with (matkat, params)

Hakuparametrit:<br>
$for k, v in params.iteritems():
  $k=<strong>$v</strong><br>

$if len(matkat) == 0 or matkat is None:
  <h1>Ei tuloksia</h1>

$else:
  <h1>Löytyneet yhteydet:</h1>
  $if "juna" in matkat:
    <h2>Junayhteydet:</h2>
    $if "virhe" in matkat["juna"]:
      <strong>Virhe! $matkat["juna"]["virhe"]</strong>
    $else:
      $for yhteys in matkat["juna"]:
        <strong>$loop.index. yhteys:</strong>
        Lähtee: $yhteys["lahtoaika"]<br>
        Saapuu: $yhteys["saapumisaika"]<br>
        Kesto: $yhteys["kesto"] Hinta: $yhteys["hinnat"][0]€<br>
        Vaihdot:<br>
        $for vaihto in yhteys["vaihdot"]:
          $if "lahtopaikka" in vaihto:
            $loop.index. vaihto: $vaihto["tyyppi"] $vaihto["lahtopaikka"] - $vaihto["saapumispaikka"] ($vaihto["lahtoaika"].split()[-1] - $vaihto["saapumisaika"].split()[-1])<br>
          $elif "mista" in vaihto:
            $loop.index. vaihto: $vaihto["tyyppi"] $vaihto["mista"] - $vaihto["mihin"] ($vaihto["lahtoaika"].split()[-1] - $vaihto["saapumisaika"].split()[-1])<br>
        <br>

  $if "bussi" in matkat:
    <h2>Bussiyhteydet:</h2>
    $if "virhe" in matkat["bussi"]:
      <strong>Virhe!</strong> $matkat["bussi"]["virhe"]
    $else:
      $for yhteys in matkat["bussi"]:
        Lähtee: $yhteys["lahtoaika"]<br>
        Saapuu: $yhteys["saapumisaika"]<br>
        Kesto: $yhteys["kesto"]<br>
        Hinta: $yhteys["hinnat"][0]<br>
        Tähän vaihdot yms.<br>
        <br>

  $if "auto" in matkat:
    <h2>Autoyhteydet:</h2>
    $if "virhe" in matkat["auto"]:
      <strong>Virhe!</strong> $matkat["auto"]["virhe"]
    $else:
      Mistä: $matkat["auto"]["mista"]<br>
      Mihin: $matkat["auto"]["mihin"]<br>
      Matkan pituus: $matkat["auto"]["matkanpituus"] km<br>
      Kesto: $matkat["auto"]["kesto"]<br>
      $if "hinnat" in matkat["auto"]:
        $ h1, h2, strong = matkat["auto"]["hinnat"]
        Hinnat: <b>$h1</b>€ (95E10), <b>$h2</b>€ (98E), <b>$strong</b>€ (Diesel)<br>

<a href="/">Takaisin</a>
